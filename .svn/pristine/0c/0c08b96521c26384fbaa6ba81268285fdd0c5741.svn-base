<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.example.demo.mapper.AjaxMapper">

  <!-- 리스트 View -->
  <select id="selectListAll" resultType="com.example.demo.dto.AjaxDto">
		SELECT * 
		FROM (SELECT ROWNUM rnum, 
					 a.* 
			  FROM(SELECT user_id,
				          title_ajax,
				          contents_ajax,
				          date_ajax,
				          postNum_ajax,
				          groupNum_ajax,
				          indentNum_ajax,
				          stepNum_ajax,
				          hitNum_ajax
					FROM hu_ajax
					ORDER BY groupNum_ajax DESC, 
							 stepNum_ajax ASC) a)
		WHERE rnum >= #{startRow} 
		AND rnum &lt;= #{endRow}
  </select>
  
  
  <!-- 페이지 넘버링 - 총 게시물 개수 확인 -->
  <select id="listCount" resultType="int">
		SELECT Count(*) 
		FROM hu_ajax
  
  </select>
  
  <!-- 글쓰기 -->
   <insert id="insertWrite">
		insert into hu_ajax(user_id,
							title_ajax,
							contents_ajax,
							date_ajax,
							postNum_ajax,
							groupNum_ajax,
							indentNum_ajax,
							stepNum_ajax,
							hitNum_ajax) 
					values(#{user_id},
						   #{title_ajax},
						   #{contents_ajax},
						   sysdate,
						   ajax_seq.nextval,
						   ajax_seq.currval,
						   0,
						   0,
						   0)
  </insert>
  
  
  <!-- 리스트 - 방금 저장된 튜플 가져오기 -->
  <select id="selectListOne" resultType="com.example.demo.dto.AjaxDto">
		SELECT user_id,
			   title_ajax,
			   contents_ajax,
			   date_ajax,
			   postNum_ajax,
			   groupNum_ajax,
			   indentNum_ajax,
			   stepNum_ajax,
			   hitNum_ajax
		FROM hu_ajax
		WHERE date_ajax = (SELECT Max(date_ajax) 
						   FROM hu_ajax)
  </select>



  <!-- 상세 페이지 -->
<!--   <select id="selectView" resultType="com.example.demo.dto.AjaxDto">
		SELECT user_id,
		       title_ajax,
		       contents_ajax,
		       date_ajax,
		       postNum_ajax,
		       groupNum_ajax,
		       indentNum_ajax,
		       stepNum_ajax,
		       hitNum_ajax
		FROM hu_ajax
		WHERE postNum_ajax=#{postNum_ajax}
  </select> -->
  

  <!-- 조회수 1 증가 처리 -->
 <!--  <update id="updateHitNum">
		UPDATE hu_ajax 
		SET hitNum_ajax = hitNum_ajax+1 
		WHERE postNum_ajax = #{postNum_ajax}
  </update> -->
  
  
  
  <!-- 상세페이지 내 - 이전글 가져오기 --> 
 <!--  <select id="selectPreDto" resultType="com.example.demo.dto.AjaxDto">
		SELECT * 
		
		FROM (SELECT rownum rnum, 
					 a.* 
			  FROM (SELECT * 
			  		FROM hu_ajax
					ORDER BY groupNum_ajax DESC, stepNum_ajax ASC) a)
		WHERE rnum=(SELECT rnum 
					FROM (SELECT rownum rnum, 
								 a.* 
						  FROM (SELECT * 
						  		FROM hu_ajax
								ORDER BY groupNum_ajax DESC, 
										 stepNum_ajax ASC) a)
					WHERE postNum_ajax=#{postNum_ajax})+1
  </select> -->
  
  
  <!-- 상세페이지 내 - 다음글 가져오기 --> 
 <!--  <select id="selectNextDto" resultType="com.example.demo.dto.AjaxDto">
		SELECT * 
		
		FROM (SELECT rownum rnum, 
					 a.* 
			  FROM (SELECT * 
			  		FROM hu_ajax
					ORDER BY groupNum_ajax DESC, stepNum_ajax ASC) a)
		WHERE rnum=(SELECT rnum 
					FROM (SELECT rownum rnum, 
								 a.* 
						  FROM (SELECT * 
						  		FROM hu_ajax
								ORDER BY groupNum_ajax DESC, 
										 stepNum_ajax ASC) a)
					WHERE postNum_ajax=#{postNum_ajax})-1
  </select> -->



  <!-- 글 삭제하기 -->
<!--   <delete id="deleteChk">
		DELETE FROM hu_ajax
		WHERE postNum_ajax=#{postNum_ajax}
  </delete>   -->


  
</mapper>
