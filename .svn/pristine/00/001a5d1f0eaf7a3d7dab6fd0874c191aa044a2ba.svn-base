<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
	<html>
	<head>
		<meta charset="UTF-8">
		<title>Ajax 게시판</title>
		<link rel="stylesheet" href="../css/ajax/ajaxList.css">
		<link rel="stylesheet" href="../css/board/style.css">
  		<link rel="stylesheet" href="../css/board/listStyle.css">
  		<script src="http://code.jquery.com/jquery-latest.min.js"></script>
  		<script type="text/javascript">
  			function ajaxWrite(){
  				
  				// 만들 팝업창 좌우 크기의 1/2 만큼 보정값으로 빼주었음
	  			var popupX = (window.screen.width / 2) - (600 / 2);
	  			// 만들 팝업창 상하 크기의 1/2 만큼 보정값으로 빼주었음
	  			var popupY= (window.screen.height /2) - (400 / 2);
	  			
	  			window.open("./write", "_blank", "status=no, width=800, height=550, left="+popupX+", top="+popupY+", screenX="+popupX+", screenY="+popupY);
  			}//ajaxWrite()
  		</script>
	</head>
	<body>
		<c:choose>
			<c:when test="${session_flag eq 'success'}">
				<!-- header 추가 -->
				<div>
					<%@ include file="../header.jsp"%>
				</div>
				<div id="board_outline">
					<div id="contents_area">
						<section>
							<h1>AJAX 게시판</h1>
							<div class="wrapper">
								<form action="/search" name="search" method="post">
									<select name="category" id="category">
										<option value="0">전체</option>
										<option value="title">제목</option>
										<option value="content">내용</option>
									</select>
	
									<div class="title">
										<input type="text" size="16">
									</div>
	
									<button type="submit">찾기</button>
								</form>
							</div>
	
							<table>
								<colgroup>
									<col width="18%">
									<col width="50%">
									<col width="18%">
									<col width="10%">
								</colgroup>
								<!-- 제목부분 -->
								<tr>
									<th>No.</th>
									<th>제목</th>
									<th>작성일</th>
									<th>조회수</th>
								</tr>
								<!-- 내용부분 -->
								<!-- 반복 시작 -->
								<tbody id="tbody">
								<c:forEach var="dto" items="${map.list}">
									<tr>
										<td><span class="table-notice">${dto.postNum_ajax}</span></td>
										<td class="table-title">
											<a href="/ajax/view?postNum_ajax=${dto.postNum_ajax}" onclick="window.open(this.href, '_blank', 'width=600, height=500'); return false;">${dto.title_ajax}</a>
										</td>
										<td>${dto.date_ajax}</td>
										<td>${dto.hitNum_ajax}</td>
									</tr>
								</c:forEach>
								</tbody>
							</table>
							
							<!-- 페이지 넘버링 시작 -->
							<ul class="page-num">
								<!-- 제일 첫 페이지로 -->
								<a href="/ajax/list?page=1">
									<li class="first"></li>
								</a>
								
								<!-- 이전 페이지로 이동 -->
								<c:choose>
									<c:when test="${map.page <= 1}">
										<!-- 현재 페이지가 1페이지와 같으면 링크 없음 -->
										<li class="prev"></li>
									</c:when>
									<c:otherwise>
										<a href="/ajax/list?page=${map.page-1}">
											<li class="prev"></li>
										</a>
									</c:otherwise>
								</c:choose>
								
								<!-- 페이지 반복 시작 -->
								<c:forEach var="nowPage" begin="${map.startPage}" end="${map.endPage}">
									<c:choose>
										<c:when test="${nowPage eq map.page}">
											<li class="num"><div>${nowPage}</div></li> <!-- 현재 페이지와 같으면 링크 없음 -->
										</c:when>
										<c:when test="${nowPage > 0 && nowPage != map.page}">
											<a href="/ajax/list?page=${nowPage}">
												<li class="num"><div>${nowPage}</div></li>
											</a>
										</c:when>
									</c:choose>
								</c:forEach>
								
								<!-- 다음 페이지로 이동 -->
								<c:choose>
									<c:when test="${map.page ge map.maxPage}">
										<!-- 현재 페이지가 최대페이지 이상일 경우 링크 없음 -->
										<li class="next"></li>
									</c:when>
									<c:otherwise>
										<a href="/ajax/list?page=${map.page+1}">
											<li class="next"></li>
										</a>
									</c:otherwise>
								</c:choose>
								
								<!-- 제일 마지막 페이지로 -->
								<a href="/ajax/list?page=${map.maxPage}">
									<li class="last"></li>
								</a>
							</ul>
							<div id="btn_menu">
								<div class="write" onclick="ajaxWrite()" id="ajaxWriteBtn">쓰기</div>
							</div>
	
						</section>
					</div>
				</div>
			</c:when>
			<c:otherwise>
				<script type="text/javascript">
					alert("로그인 후 이용가능합니다.");
					location.href="/login";
				</script>
			</c:otherwise>
		</c:choose>
		
	
	</body>
</html>